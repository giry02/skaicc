# 욕설/강성 민원 발생 시 상담원 즉시 호전환 (Barge-in & Handoff)

AICC 특성상 실시간 페르소나 변경(LLM Tuning)이 어렵고 리스크가 크므로, **즉시 상담원 연결(Handoff)**로 대응하는 표준 절차입니다.

## 1. 감지 로직 (Detection)
*   **방식**: Rule-based Keyword Matching (가장 빠르고 확실함)
*   **필터링 대상**: 욕설 DB, 모욕적 표현, "상담원 바꿔", "사람 바꿔" 등 강력한 요구 사항
*   **Trigger**: STT 결과(Partial/Final)에서 키워드 검출 즉시 발동

## 2. 대응 시나리오 (Action Flow)

### Step 1: 봇 발화 중단 (Stop)
*   고객이 욕설을 내뱉는 순간(Barge-in), 봇은 **즉시 입을 다물어야 합니다.** (가장 중요)
*   계속 떠들면 고객 분노 게이지 상승.

### Step 2: 사과 및 안내 (Apology & Guide)
*   **TTS가 아닌 'Pre-recorded Audio(성우 녹음)'** 송출 권장 (더 정중하고 안정적인 톤).
*   **멘트**: "고객님, 많이 불편하셨군요. 불편을 드려 죄송합니다. 전문 상담원에게 바로 연결해 드리겠습니다."

### Step 3: 호 전환 (Transfer)
*   **Routing**: 일반 대기열이 아닌 **'VIP/불만 고객 전담 큐(Priority Queue)'**로 최우선 배정.
*   **Data Passing**: 상담원 화면(Softphone)에 **"사유: 강성 민원/욕설 감지"** 팝업 띄움.
*   (옵션) 상담원 연결 전, 고객에게 진정할 시간(Music)을 5~10초 부여.

## 3. 예외 처리 (Exception)
*   **상담원 부재 시**: "죄송합니다. 현재 모든 상담원이 통화 중입니다. 남겨주신 번호로 10분 내에 담당 팀장이 직접 전화드리겠습니다." (콜백 예약)

## 4. [New] Barge-in 타이밍 분석 (Analytics)
**"고객이 도대체 봇이 무슨 말을 할 때 끊었는가?"**를 분석하여 시나리오를 최적화합니다.

*   **측정 방식**: `Barge-in Timestamp` - `TTS Start Timestamp` = **경과 시간(Duration)**
*   **데이터 활용**:
    1.  **0~3초 (초반 끊김)**: "자기소개가 너무 깁니다." -> 인사말 단축 필요.
    2.  **특정 키워드 구간 끊김**: "이벤트 안내를..." 할 때마다 끊긴다면? -> 그 이벤트 매력 없는 겁니다. 삭제하세요.
    3.  **End-point 끊김**: 말 다 듣고 끊음 -> 정상 반응.
*   **리포트 예시**:
    > "전체 콜의 40%가 '본인인증' 설명 시작 후 2.5초 지점에서 이탈했습니다. 해당 구간 멘트를 간소화하세요."
